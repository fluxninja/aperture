# Generated values file for policies/service-protection/average-latency blueprint
# Documentation/Reference for objects and parameters can be found at:
# https://docs.fluxninja.com/reference/policies/bundled-blueprints/policies/service-protection/average-latency

common:
  # Name of the policy.
  # Type: string
  # Required: True
  policy_name: __REQUIRED_FIELD__

policy:
  service_protection_core:
    adaptive_load_scheduler:
      # Concurrency Limiter flow selector.
      # Type: aperture.spec.v1.FlowSelector
      # Required: True
      flow_selector:
        flow_matcher:
          control_point: __REQUIRED_FIELD__
        service_selector:
          service: __REQUIRED_FIELD__
      # Scheduler schemaeters.
      # Type: aperture.spec.v1.Schedulerschemaeters
      scheduler:
        auto_tokens: true
      # Gradient Controller schemaeters.
      # Type: aperture.spec.v1.GradientControllerschemaeters
      gradient:
        max_gradient: 1
        min_gradient: 0.1
        slope: -1
      # Whether tokens for workloads are computed dynamically or set statically by the user.
      # Type: aperture.spec.v1.Alerterschemaeters
      alerter:
        alert_name: "Load Shed Event"
      # Current accepted concurrency is multiplied with this number to dynamically calculate the upper concurrency limit of a Service during normal (non-overload) state. This protects the Service from sudden spikes.
      # Type: float64
      max_load_multiplier: 2
      # Linear increment to load multiplier in each execution tick (0.5s) when the system is not in overloaded state.
      # Type: float64
      load_multiplier_linear_increment: 0.0025
      # Default configuration for concurrency controller that can be updated at the runtime without shutting down the
      # Type: aperture.spec.v1.LoadActuatorDynamicConfig
      default_config:
        dry_run: false
  # Flux Meter.
  # Type: aperture.spec.v1.FluxMeter
  # Required: True
  flux_meter:
    flow_selector:
      flow_matcher:
        control_point: __REQUIRED_FIELD__
      service_selector:
        service: __REQUIRED_FIELD__
