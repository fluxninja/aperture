{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "policies/service-protection-with-load-based-pod-auto-scaler/average-latency blueprint",
  "additionalProperties": false,
  "required": ["policy"],
  "properties": {
    "policy": {
      "description": "Configuration for the Service Protection policy.",
      "default": {
        "auto_scaling": {
          "dry_run": false,
          "periodic_decrease": {
            "period": "60s",
            "scale_in_percentage": 10
          },
          "promql_scale_in_controllers": [],
          "promql_scale_out_controllers": [],
          "scaling_backend": {
            "kubernetes_replicas": {
              "kubernetes_object_selector": "__REQUIRED_FIELD__",
              "max_replicas": "__REQUIRED_FIELD__",
              "min_replicas": "__REQUIRED_FIELD__"
            }
          },
          "scaling_parameters": {
            "scale_in_alerter": {
              "alert_name": "Auto-scaler is scaling in"
            },
            "scale_in_cooldown": "40s",
            "scale_out_alerter": {
              "alert_name": "Auto-scaler is scaling out"
            },
            "scale_out_cooldown": "30s"
          }
        },
        "components": [],
        "evaluation_interval": "1s",
        "latency_baseliner": {
          "ema": {
            "correction_factor_on_max_envelope_violation": 0.95,
            "ema_window": "1500s",
            "warmup_window": "60s"
          },
          "flux_meter": {
            "selectors": [
              {
                "control_point": "__REQUIRED_FIELD__",
                "service": "__REQUIRED_FIELD__"
              }
            ]
          },
          "latency_ema_limit_multiplier": 2,
          "latency_tolerance_multiplier": 1.1
        },
        "policy_name": "__REQUIRED_FIELD__",
        "resources": {
          "flow_control": {
            "classifiers": []
          }
        },
        "service_protection_core": {
          "adaptive_load_scheduler": {
            "alerter": {
              "alert_name": "Load Throttling Event"
            },
            "gradient": {
              "max_gradient": 1,
              "min_gradient": 0.1,
              "slope": -1
            },
            "load_multiplier_linear_increment": 0.0025,
            "load_scheduler": {
              "selectors": [
                {
                  "control_point": "__REQUIRED_FIELD__",
                  "service": "__REQUIRED_FIELD__"
                }
              ]
            },
            "max_load_multiplier": 2
          },
          "dry_run": false,
          "overload_confirmations": []
        }
      },
      "type": "object",
      "$ref": "../../../../policies/service-protection/average-latency/gen/definitions.json#/properties/policy"
    },
    "dashboard": {
      "description": "Configuration for the Grafana dashboard accompanying this policy.",
      "default": {
        "datasource": {
          "filter_regex": "",
          "name": "$datasource"
        },
        "extra_filters": {},
        "refresh_interval": "15s",
        "time_from": "now-15m",
        "time_to": "now",
        "title": "Aperture Service Protection",
        "variant_name": "Average Latency"
      },
      "type": "object",
      "$ref": "../../../../policies/service-protection/average-latency/gen/definitions.json#/properties/dashboard"
    }
  },
  "$defs": null
}
