{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "policies/feature-rollout/ema-latency blueprint",
  "additionalProperties": false,
  "required": ["common", "policy"],
  "properties": {
    "common": {
      "type": "object",
      "additionalProperties": false,
      "required": ["policy_name"],
      "properties": {
        "policy_name": {
          "description": "Name of the policy.",
          "default": "__REQUIRED_FIELD__",
          "type": "string"
        }
      }
    },
    "policy": {
      "description": "Parameters for the Feature Rollout policy.",
      "default": {
        "components": [],
        "drivers": {
          "ema_latency_drivers": [
            {
              "criteria": {
                "backward": {
                  "latency_tolerance_multiplier": 1.05
                },
                "forward": {
                  "latency_tolerance_multiplier": 1.05
                },
                "reset": {
                  "latency_tolerance_multiplier": 1.25
                }
              },
              "ema": {
                "ema_window": "1500s",
                "warmup_window": "60s"
              },
              "selectors": [
                {
                  "control_point": "__REQUIRED_FIELD__",
                  "service": "__REQUIRED_FIELD__"
                }
              ]
            }
          ]
        },
        "evaluation_interval": "1s",
        "load_ramp": {
          "regulator_parameters": {
            "label_key": "",
            "selectors": [
              {
                "control_point": "__REQUIRED_FIELD__",
                "service": "__REQUIRED_FIELD__"
              }
            ]
          },
          "steps": [
            {
              "duration": "__REQUIRED_FIELD__",
              "target_accept_percentage": "__REQUIRED_FIELD__"
            }
          ]
        },
        "resources": {
          "flow_control": {
            "classifiers": []
          }
        }
      },
      "type": "object",
      "$ref": "../../../../policies/feature-rollout/base/gen/definitions.json#/$defs/rollout_policy"
    },
    "dashboard": {
      "description": "Configuration for the Grafana dashboard accompanying this policy.",
      "default": {
        "datasource": {
          "filter_regex": "",
          "name": "$datasource"
        },
        "refresh_interval": "5s",
        "time_from": "now-15m",
        "time_to": "now"
      },
      "type": "object",
      "$ref": "../../../../policies/feature-rollout/base/gen/definitions.json#/properties/dashboard"
    }
  },
  "$defs": null
}
