# yaml-language-server: $schema=../../../../../../blueprints/policies/service-protection-with-load-based-pod-auto-scaler/average-latency/gen/definitions.json
# Generated values file for policies/service-protection-with-load-based-pod-auto-scaler/average-latency blueprint
# Documentation/Reference for objects and parameters can be found at:
# https://docs.fluxninja.com/reference/policies/bundled-blueprints/policies/service-protection-with-load-based-pod-auto-scaler/average-latency

policy:
  # Name of the policy.
  # Type: string
  # Required: True
  policy_name: load-based-auto-scale
  service_protection_core:
    adaptive_load_scheduler:
      load_scheduler:
        # The selectors determine the flows that are protected by this policy.
        # Type: []aperture.spec.v1.Selector
        # Required: True
        selectors:
          - control_point: ingress
            service: service1-demo-app.demoapp.svc.cluster.local
  latency_baseliner:
    # Flux Meter defines the scope of latency measurements.
    # Type: aperture.spec.v1.FluxMeter
    # Required: True
    flux_meter:
      selectors:
        - control_point: ingress
          service: service1-demo-app.demoapp.svc.cluster.local
  auto_scaling:
    # Kubernetes replicas scaling backend.
    # Type: aperture.spec.v1.AutoScalerScalingBackendKubernetesReplicas
    # Required: True
    kubernetes_replicas:
      # Kubernetes object selector.
      # Type: aperture.spec.v1.KubernetesObjectSelector
      # Required: True
      kubernetes_object_selector:
        agent_group: default
        api_version: apps/v1
        kind: Deployment
        name: service1-demo-app
        namespace: demoapp
      # Minimum number of replicas.
      # Type: string
      # Required: True
      min_replicas: "1"
      # Maximum number of replicas.
      # Type: string
      # Required: True
      max_replicas: "10"
    # Dry run mode ensures that no scaling is invoked by this auto scaler.
    # Type: bool
    dry_run: false
    # Configuration key for overriding dry run setting through dynamic configuration.
    # Type: string
    dry_run_config_key: "auto_scaling"
    # Parameters that define the scaling behavior.
    # Type: aperture.spec.v1.AutoScalerScalingParameters
    # Required: True
    scaling_parameters:
      scale_in_cooldown: "40s"
      scale_out_cooldown: "30s"
